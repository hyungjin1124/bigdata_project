-- seoul_top_10
SELECT	*
  FROM	(SELECT  A.SIGUNGU_NAME, A.CNT_NAME, ROW_NUMBER() OVER(ORDER BY CNT_NAME DESC) as RN
  FROM  (SELECT  SIGUNGU_NAME, COUNT(BUSINESS_NAME) AS CNT_NAME
          FROM  SANGA
         GROUP  
            BY  SIGUNGU_NAME) as A) as B
 WHERE	B.RN BETWEEN 1 AND 10;

-- BIG_SECTOR_SIGUNGU_TOP10
SELECT  *
  FROM  (SELECT  A.BIG_SECTOR, A.SIGUNGU_NAME, A.CNT_NAME
        ,ROW_NUMBER() OVER (PARTITION BY A.BIG_SECTOR ORDER BY BIG_SECTOR, A.CNT_NAME DESC) rn
  FROM  (SELECT  BIG_SECTOR, SIGUNGU_NAME, COUNT(BUSINESS_NAME) AS CNT_NAME
          FROM  SANGA
         GROUP
            BY  BIG_SECTOR, SIGUNGU_NAME) A) B
 WHERE  B.rn <= 10;
 
-- BIG_SECTOR_HENGJUNGDONG_TOP10
SELECT  *
  FROM  (SELECT  A.BIG_SECTOR, A.SIGUNGU_NAME, A.HENGJUNGDONG_NAME,  A.CNT_NAME
        ,ROW_NUMBER() OVER (PARTITION BY A.BIG_SECTOR ORDER BY BIG_SECTOR, A.CNT_NAME DESC)AS rn
  FROM  (SELECT  BIG_SECTOR, HENGJUNGDONG_NAME, SIGUNGU_NAME, COUNT(BUSINESS_NAME) AS CNT_NAME
          FROM  SANGA
         GROUP
            BY  BIG_SECTOR, HENGJUNGDONG_NAME, SIGUNGU_NAME) A) B
 WHERE  B.rn <= 10;
 
-- MID_SECTOR_SIGUNGU_TOP10
SELECT  *
  FROM  (SELECT  A.MEDIUM_SECTOR, A.SIGUNGU_NAME, A.CNT_NAME
        ,ROW_NUMBER() OVER (PARTITION BY A.MEDIUM_SECTOR ORDER BY MEDIUM_SECTOR, A.CNT_NAME DESC)AS rn
  FROM  (SELECT  MEDIUM_SECTOR, SIGUNGU_NAME, COUNT(BUSINESS_NAME) AS CNT_NAME
          FROM  SANGA
         GROUP
            BY  MEDIUM_SECTOR, SIGUNGU_NAME) A) B
 WHERE  B.rn <= 10;
 
-- MID_SECTOR_HENGJUNGDONG_TOP10
INSERT INTO MID_SECTOR_HENGJUNGDONG_TOP10
 SELECT  *
  FROM  (SELECT  A.MEDIUM_SECTOR, A.SIGUNGU_NAME, A.HENGJUNGDONG_NAME, A.CNT_NAME
        ,ROW_NUMBER() OVER (PARTITION BY A.MEDIUM_SECTOR ORDER BY MEDIUM_SECTOR, A.CNT_NAME DESC)AS rn
  FROM  (SELECT  MEDIUM_SECTOR, HENGJUNGDONG_NAME, SIGUNGU_NAME, COUNT(BUSINESS_NAME) AS CNT_NAME
          FROM  SANGA
         GROUP
            BY  MEDIUM_SECTOR, HENGJUNGDONG_NAME, SIGUNGU_NAME) A) B
 WHERE  B.rn <= 10;
 
-- SIGUNGU_BIG_SECTOR_TOP5
SELECT  *
  FROM  (SELECT  A.SIGUNGU_NAME, A.BIG_SECTOR, A.CNT_NAME
        ,ROW_NUMBER() OVER (PARTITION BY A.SIGUNGU_NAME ORDER BY SIGUNGU_NAME, A.CNT_NAME DESC)AS rn
  FROM  (SELECT  SIGUNGU_NAME, BIG_SECTOR, COUNT(BUSINESS_NAME) AS CNT_NAME
          FROM  SANGA
         GROUP
            BY  SIGUNGU_NAME, BIG_SECTOR) A) B
 WHERE  B.rn <= 5;
 
-- HENGJUNGDONG_BIG_SECTOR_TOP5
SELECT  *
  FROM  (SELECT  A.SIGUNGU_NAME, A.HENGJUNGDONG_NAME, A.BIG_SECTOR, A.CNT_NAME
        ,ROW_NUMBER() OVER (PARTITION BY A.HENGJUNGDONG_NAME ORDER BY A.HENGJUNGDONG_NAME, A.CNT_NAME DESC)AS rn
  FROM  (SELECT HENGJUNGDONG_NAME, SIGUNGU_NAME, BIG_SECTOR, COUNT(BUSINESS_NAME) AS CNT_NAME
          FROM  SANGA
         GROUP
            BY  HENGJUNGDONG_NAME, SIGUNGU_NAME, BIG_SECTOR) A) B
 WHERE  B.rn <= 5;
 
-- SIGUNGU_BIG_SECTOR_TOP1
SELECT  *
  FROM  (SELECT  A.SIGUNGU_NAME, A.BIG_SECTOR, A.CNT_NAME
        ,ROW_NUMBER() OVER (PARTITION BY A.SIGUNGU_NAME ORDER BY SIGUNGU_NAME, A.CNT_NAME DESC)AS rn
  FROM  (SELECT  SIGUNGU_NAME, BIG_SECTOR, COUNT(BUSINESS_NAME) AS CNT_NAME
          FROM  SANGA
         GROUP
            BY  SIGUNGU_NAME, BIG_SECTOR) A) B
 WHERE  B.rn = 1;
 
-- HENGJUNGDONG_BIG_SECTOR_TOP1
SELECT  *
  FROM  (SELECT  A.SIGUNGU_NAME, A.HENGJUNGDONG_NAME, A.BIG_SECTOR, A.CNT_NAME
        ,ROW_NUMBER() OVER (PARTITION BY A.HENGJUNGDONG_NAME ORDER BY A.HENGJUNGDONG_NAME, A.CNT_NAME DESC)AS rn
  FROM  (SELECT HENGJUNGDONG_NAME, SIGUNGU_NAME, BIG_SECTOR, COUNT(BUSINESS_NAME) AS CNT_NAME
          FROM  SANGA
         GROUP
            BY  HENGJUNGDONG_NAME, SIGUNGU_NAME, BIG_SECTOR) A) B
 WHERE  B.rn = 1;
